@if (open) {
  <div class="dialog-backdrop" (click)="onBackdropClick($event)">
    <section class="dialog" role="dialog" aria-modal="true" aria-label="Attach note">
      <header class="dialog-header">
        <h3>Attach note</h3>
        <button type="button" class="ghost-btn" (click)="close()">Close</button>
      </header>

      <div class="mode-switch">
        <button
          type="button"
          class="mode-btn"
          [class.is-active]="modeControl.value === 'verse'"
          (click)="modeControl.setValue('verse')"
        >
          Verse
        </button>
        <button
          type="button"
          class="mode-btn"
          [class.is-active]="modeControl.value === 'word'"
          (click)="modeControl.setValue('word')"
        >
          Word
        </button>
      </div>

      @if (modeControl.value === 'verse') {
        <div class="field-row">
          <label>
            Surah
            <select [formControl]="surahControl">
              @for (surah of surahOptions; track surah) {
                <option [value]="surah">{{ surah }}</option>
              }
            </select>
          </label>
          <label>
            Ayah
            <input [formControl]="ayahControl" type="number" min="1" placeholder="4" />
          </label>
        </div>
        @if (verseError()) {
          <p class="error">{{ verseError() }}</p>
        }
      } @else {
        <label class="field-block">
          Word ref
          <input [formControl]="wordRefControl" type="text" placeholder="12:1:3" />
        </label>
        @if (wordError()) {
          <p class="error">{{ wordError() }}</p>
        }
      }

      @if (saveError()) {
        <p class="error">{{ saveError() }}</p>
      }

      <footer class="dialog-footer">
        <button type="button" class="ghost-btn" (click)="close()" [disabled]="saving()">Cancel</button>
        <button type="button" class="primary-btn" (click)="save()" [disabled]="saving()">
          {{ saving() ? 'Saving...' : 'Attach' }}
        </button>
      </footer>
    </section>
  </div>
}
