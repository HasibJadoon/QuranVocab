<div [formGroup]="groupForm">
  <div class="input-group input-group-sm border-force mb-1">
    <div class="input-group-prepend">
      <span class="input-group-text"><i class="far fa-fw" [ngClass]="waiting ? 'fa-spinner fa-pulse' : 'fa-location-arrow'"></i></span>
    </div>
    <input
      autocorrect="off"
      autocapitalize="off"
      spellcheck="false"
      autocomplete="off"
      placeholder="{{ 'SEARCH_FIELD.FILTERS.GEO_WITHIN.WRITE_PLACE' | translate }}"
      class="form-control"
      [(ngModel)]="input"
      (ngModelChange)="inputSubject.next(input)"
      [ngModelOptions]="{ standalone: true }"
      [disabled]="groupForm.get('base').value?.isPoint"
    />
    <div class="input-group-append">
      <button class="btn btn-outline-secondary last-child-form-control" type="button" (click)="doClearPlace()" tabindex="-1" [disabled]="input == null">
        <i class="far fa-times"></i>
      </button>
      <button type="button" class="btn btn-outline-secondary" (click)="doBaseChange()">
        <i class="far fa-map" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <div *ngIf="list && list.length > 0; else empty" class="d-flex flex-column border mb-1 text-truncate">
    <div *ngFor="let l of list">
      <button class="dropdown-item p-1" type="button" (click)="doPlaceSelected(l)">
        <div class="d-flex flex-row" style="min-width: 0">
          <div class="d-flex flex-column justify-content-center align-items-center mr-1">
            <i class="fa-fw fa-lg" [ngClass]="l.types | placeicon"></i>
          </div>
          <div class="flex-grow-1 d-flex flex-column" style="min-width: 0">
            <div class="text-truncate">{{ l.name }}</div>
            <small class="font-weight-light text-truncate" style="font-size: 0.875rem">{{ l.structured_formatting?.secondary_text }}</small>
          </div>
        </div>
      </button>
    </div>
  </div>
  <ng-template #empty>
    <div *ngIf="input && (!groupForm.get('base').value || waiting)" class="d-flex flex-row justify-content-center mt-1">
      <span class="font-italic font-weight-light small">{{ waiting ? '...' : ('COMMON.EMPTY_RESULT' | translate) }}</span>
    </div>
  </ng-template>
  <div class="input-group input-group-sm border-force">
    <input class="form-control" type="number" [name]="key + 'radius'" placeholder="{{ 'SEARCH_FIELD.FILTERS.GEO_WITHIN.RADIUS' | translate : { unit: unit } }}" formControlName="radius" [control-active]="true" />
  </div>
</div>
