<form [ngClass]="greyedOut ? 'greyed-out': ''" [formGroup]="dateFieldForm" novalidate>
  <div class="input-group" [class.border-force]="borderForce" [ngClass]="size === 'large' ? 'input-group-lg' : size === 'small' ? 'input-group-sm' : ''">
    <input
      type="text"
      formControlName="date"
      class="form-control"
      autocomplete="off"
      [matDatepicker]="datePicker"
      [class.is-invalid]="(required || timeRequired) && dateFieldForm.get('time').value && dateFieldForm.get('date').hasError('required')"
      [control-active]="(dateFieldForm.controls['date'].dirty && dateFieldForm.controls['date'].touched) || submitAttempt"
      [required]="required"
      [matDatepickerFilter]="myFilter"
      [style.font-weight]="fontWeight"
    />
    <mat-datepicker #datePicker autoTouchUi [startAt]="startAt"></mat-datepicker>
    <div *ngIf="!isDisabled" class="input-group-prepend input-group-append">
      <button class="btn btn-outline-secondary" type="button" (click)="datePicker.open()" tabindex="-1" [disabled]="dateFieldForm.controls['date'].disabled || disableDate">
        <i class="far fa-calendar-alt"></i>
      </button>
    </div>
    <input
      *ngIf="showTime"
      class="form-control"
      type="time"
      required
      formControlName="time"
      [typeahead]="times"
      [class.is-invalid]="timeRequired && dateFieldForm.get('date').value && dateFieldForm.get('time').hasError('required')"
      autocomplete="false"
      [typeaheadScrollable]="true"
      [typeaheadOptionsInScrollableView]="5"
      [typeaheadMinLength]="0"
      [typeaheadOptionsLimit]="times.length"
      [control-active]="(dateFieldForm.controls['time'].dirty && dateFieldForm.controls['time'].touched) || submitAttempt"
      [required]="timeRequired"
      [style.font-weight]="fontWeight"
    />
    <div class="input-group-append" *ngIf="!isDisabled">
      <button *ngIf="showTodayButton" class="btn btn-outline-secondary" type="button" (click)="doToday()" tabindex="-1" [disabled]="dateFieldForm.controls['date'].disabled">
        <i class="far fa-calendar-day"></i>
      </button>
      <button class="btn btn-outline-secondary last-child-form-control" type="button" (click)="doClear()" tabindex="-1" [disabled]="isDisableReset">
        <i class="far fa-times"></i>
      </button>
    </div>
    <div class="invalid-feedback">
      {{ getDateErrorMessage() | translate }}
    </div>
  </div>
</form>
