<c-dropdown
  [popperOptions]="{ placement: 'bottom-start', strategy: 'fixed' }"
  variant="nav-item"
  autoClose="outside"
  class="settings-dropdown-host"
>
  <button [caret]="false" cDropdownToggle class="py-0 pe-0" aria-label="Open user menu">
    <span class="settings-avatar">
      <svg cIcon name="cilSettings" size="lg"></svg>
    </span>
  </button>

  <ul cDropdownMenu class="pt-0 settings-dropdown-menu">
    <li class="settings-shell">
      <div class="settings-panel">
        <div class="settings-panel-tabs" role="tablist" aria-label="Appearance tabs">
          <button
            type="button"
            class="settings-tab"
            [class.active]="activePreviewTab === 'arabic'"
            (click)="setPreviewTab('arabic')"
          >
            Arabic
          </button>
          <button
            type="button"
            class="settings-tab"
            [class.active]="activePreviewTab === 'english'"
            (click)="setPreviewTab('english')"
          >
            English
          </button>
          <button
            type="button"
            class="settings-tab"
            [class.active]="activePreviewTab === 'system'"
            (click)="setPreviewTab('system')"
          >
            Sys
          </button>
        </div>

        <div class="settings-panel-body">
          <div class="settings-panel-header">
            <div>
              <p class="settings-panel-label">Preview</p>
              <h3>
                {{
                  activePreviewTab === 'english'
                    ? 'English appearance'
                    : activePreviewTab === 'system'
                      ? 'System appearance'
                      : 'Arabic appearance'
                }}
              </h3>
            </div>
          </div>

          <div class="settings-preview-section">
            <p class="settings-section-title">Preview:</p>

            <article class="preview-card" aria-live="polite">
              <div
                *ngIf="activePreviewTab === 'arabic'"
                class="preview-box preview-box--arabic"
                [style.fontFamily]="selectedFontStyle"
                [style.fontSize.px]="arabicFontSize"
              >
                {{ previewArabicText }}
              </div>

              <div
                *ngIf="activePreviewTab === 'english'"
                class="preview-box preview-box--english"
                [style.fontSize.px]="previewTranslationFontSize"
              >
                {{ previewTranslationText }}
              </div>

              <div *ngIf="activePreviewTab === 'system'" class="preview-box preview-box--system">
                <div class="system-preview-row" [style.fontSize.px]="menuTextSize">Menu text sample</div>
                <div class="system-preview-row" [style.fontSize.px]="headerTextSize">Header text sample</div>
                <div class="system-preview-row" [style.fontSize.px]="footerTextSize">Footer text sample</div>
              </div>
            </article>
          </div>

          <ng-container [ngSwitch]="activePreviewTab">
            <div *ngSwitchCase="'arabic'">
              <div class="setting-group">
                <p class="setting-title">Script type</p>
                <div class="script-toggle">
                  <button
                    type="button"
                    *ngFor="let script of scriptModes"
                    class="script-btn"
                    [class.active]="selectedScriptMode === script"
                    (click)="selectScriptMode(script)"
                  >
                    {{ script }}
                  </button>
                </div>
              </div>

              <div class="setting-group">
                <p class="setting-title">Font style</p>
                <div class="font-style-chip">{{ selectedFontStyle }}</div>
              </div>

              <div class="setting-group">
                <p class="setting-title">Arabic size</p>
                <div class="range-block">
                  <span class="size-value">{{ arabicFontSize }}px</span>
                  <input
                    type="range"
                    min="14"
                    max="74"
                    step="1"
                    [value]="arabicFontSize"
                    (input)="onArabicFontSizeInput($event)"
                    class="form-range size-range"
                  />
                </div>
              </div>
            </div>

            <div *ngSwitchCase="'english'">
              <div class="setting-group">
                <p class="setting-title">English size</p>
                <div class="range-block">
                  <span class="size-value">{{ englishFontSize }}px</span>
                  <input
                    type="range"
                    min="12"
                    max="74"
                    step="1"
                    [value]="englishFontSize"
                    (input)="onEnglishFontSizeInput($event)"
                    class="form-range size-range"
                  />
                </div>
              </div>
            </div>

            <div *ngSwitchCase="'system'">
              <div class="setting-group">
                <p class="setting-title">Menu text size</p>
                <div class="range-block">
                  <span class="size-value">{{ menuTextSize }}px</span>
                  <input
                    type="range"
                    min="12"
                    max="28"
                    step="1"
                    [value]="menuTextSize"
                    (input)="onMenuTextSizeInput($event)"
                    class="form-range size-range"
                  />
                </div>
              </div>

              <div class="setting-group">
                <p class="setting-title">Header text size</p>
                <div class="range-block">
                  <span class="size-value">{{ headerTextSize }}px</span>
                  <input
                    type="range"
                    min="12"
                    max="28"
                    step="1"
                    [value]="headerTextSize"
                    (input)="onHeaderTextSizeInput($event)"
                    class="form-range size-range"
                  />
                </div>
              </div>

              <div class="setting-group">
                <p class="setting-title">Footer text size</p>
                <div class="range-block">
                  <span class="size-value">{{ footerTextSize }}px</span>
                  <input
                    type="range"
                    min="11"
                    max="28"
                    step="1"
                    [value]="footerTextSize"
                    (input)="onFooterTextSizeInput($event)"
                    class="form-range size-range"
                  />
                </div>
              </div>
            </div>
          </ng-container>
        </div>

        <div class="settings-actions">
          <button type="button" class="link-btn" (click)="resetAppearance()">Reset</button>
          <button type="button" class="primary-btn" cDropdownToggle>Done</button>
        </div>

        <div class="settings-divider"></div>

        <button class="logout-btn" type="button" (click)="logout()">
          <svg cIcon class="me-2" name="cilAccountLogout"></svg>
          Logout
        </button>
      </div>
    </li>
  </ul>
</c-dropdown>
